
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Envelope model for laser wakefield acceleration &#8212; Smilei tutorials 05aa8cc documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://www.gitcdn.xyz/cdn/mathjax/MathJax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Azimuthal-mode-decomposition cylindrical geometry" href="advanced_wakefield_AMcylindrical.html" />
    <link rel="prev" title="2D laser wakefield acceleration" href="advanced_wakefield.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="basics_setup.html">Setup</a>
                </li>
                <li class="outer">
                    <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                </li>
                <li class="outer">
                    <a href="basics_thermal_plasma.html">Thermal plasma</a>
                </li>
                <li class="outer">
                    <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="perfs_parallel_computing.html">Parallel computing</a>
                </li>
                <li class="outer">
                    <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="advanced_field_ionization.html">Field ionization</a>
                </li>
                <li class="outer">
                    <a href="advanced_collisions.html">Binary collisions and impact ionization</a>
                </li>
                <li class="outer">
                    <a href="advanced_radiation_reaction.html">Synchrotron-like Radiation reaction processes</a>
                </li>
                <li class="outer">
                    <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                </li>
            </ul>
                <ul>
<li><a class="reference internal" href="#">Envelope model for laser wakefield acceleration</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#preparing-the-case-study">Preparing the case study</a></li>
<li><a class="reference internal" href="#a-subtlety-the-envelope-of-the-vector-potential-vs-the-envelope-of-the-electric-field">A subtlety: the envelope of the vector potential vs the envelope of the electric field</a></li>
<li><a class="reference internal" href="#wakefield-excitation">Wakefield excitation</a></li>
<li><a class="reference internal" href="#parametric-study-of-self-focusing-and-wakefield-excitation">Parametric study of self-focusing and wakefield excitation</a></li>
</ul>
</li>
</ul>

            <ul>
                <li class="outer">
                    <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_electron_beam.html">Field initialization for a relativistic electron bunch</a>
                </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Envelope model for laser wakefield acceleration</a></div>
                <ul>
<li><a class="reference internal" href="#">Envelope model for laser wakefield acceleration</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#preparing-the-case-study">Preparing the case study</a></li>
<li><a class="reference internal" href="#a-subtlety-the-envelope-of-the-vector-potential-vs-the-envelope-of-the-electric-field">A subtlety: the envelope of the vector potential vs the envelope of the electric field</a></li>
<li><a class="reference internal" href="#wakefield-excitation">Wakefield excitation</a></li>
<li><a class="reference internal" href="#parametric-study-of-self-focusing-and-wakefield-excitation">Parametric study of self-focusing and wakefield excitation</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_PIC basics"
            
        >
            <div id="menuButton_PIC basics" class="menuButton"
                 onmouseenter="prepareMenu('menu_PIC basics')"
                 onmousedown="event.preventDefault()"
            >
                <a href="basics.html">
                    <span>PIC basics</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_PIC basics',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="basics_setup.html">Setup</a>
                        </li>
                        <li class="outer">
                            <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                        </li>
                        <li class="outer">
                            <a href="basics_thermal_plasma.html">Thermal plasma</a>
                        </li>
                        <li class="outer">
                            <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Performances"
            
        >
            <div id="menuButton_Performances" class="menuButton"
                 onmouseenter="prepareMenu('menu_Performances')"
                 onmousedown="event.preventDefault()"
            >
                <a href="perfs.html">
                    <span>Performances</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Performances',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="perfs_parallel_computing.html">Parallel computing</a>
                        </li>
                        <li class="outer">
                            <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Advanced"
            style="font-weight:bold"
        >
            <div id="menuButton_Advanced" class="menuButton"
                 onmouseenter="prepareMenu('menu_Advanced')"
                 onmousedown="event.preventDefault()"
            >
                <a href="advanced.html">
                    <span>Advanced</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Advanced',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="advanced_field_ionization.html">Field ionization</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_collisions.html">Binary collisions and impact ionization</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_radiation_reaction.html">Synchrotron-like Radiation reaction processes</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                        </li>
                        <li >
                            <a href="#">Envelope model for laser wakefield acceleration</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_electron_beam.html">Field initialization for a relativistic electron bunch</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
    <div class="documentwrapper">
        <div class="body" role="main">
          
  <div class="section" id="envelope-model-for-laser-wakefield-acceleration">
<h1>Envelope model for laser wakefield acceleration<a class="headerlink" href="#envelope-model-for-laser-wakefield-acceleration" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to give an introduction to the use of the laser
envelope model with <strong class="program">Smilei</strong>. Before starting with this tutorial, we
recommend to complete first the tutorial on <a class="reference internal" href="advanced_wakefield.html"><span class="doc">2D laser wakefield acceleration</span></a>. In that
Tutorial, Laser Wakefield Acceleration is simulated in a standard way, i.e. the
laser is defined through its electromagnetic fields defined on the grid.</p>
<p>We also recommend to run the simulations of this tutorial with 1 MPI process
(remember to set the number of OpenMP threads as explained in <a class="reference internal" href="basics_setup.html"><span class="doc">Setup</span></a>).</p>
<p>The following features will be addressed:</p>
<ul class="simple">
<li>Laser envelope initialization “in the box”</li>
<li>Initialization of the species interacting with the laser envelope</li>
<li>Observation of relativistic self-focusing</li>
<li>Analysis of the grid fields when an envelope is present</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial is done in 2D which is not physically relevant.
Proper simulation of this kind must be done in 3D
or in cylindrical geometry with azimuthal mode decomposition (see the related tutorial).</p>
</div>
<hr class="docutils" />
<div class="section" id="physical-configuration">
<h2>Physical configuration<a class="headerlink" href="#physical-configuration" title="Permalink to this headline">¶</a></h2>
<p>An ultra high intensity laser enters an under dense plasma. It propagates in
the plasma and creates a non linear plasma wave in its wake.</p>
</div>
<hr class="docutils" />
<div class="section" id="preparing-the-case-study">
<h2>Preparing the case study<a class="headerlink" href="#preparing-the-case-study" title="Permalink to this headline">¶</a></h2>
<p>Download <a class="reference external" href="laser_wake_envelope.py">this input file</a> and open it with your
favorite editor.</p>
<p>First, note that the laser is initialized via the use of <code class="docutils literal notranslate"><span class="pre">LaserEnvelope</span></code>
block. The laser envelope will be initialized in the box. The longitudinal
profile of the laser is called <code class="docutils literal notranslate"><span class="pre">time_envelope</span></code> in analogy with a standard
laser, but it does not represent a temporal variation. To visualize it more
easily, think of substituting the time <code class="docutils literal notranslate"><span class="pre">t</span></code> with the <code class="docutils literal notranslate"><span class="pre">x</span></code> coordinate. Thus,
the center of the laser profile (i.e. its position at <code class="docutils literal notranslate"><span class="pre">t=0</span></code>) must be chosen
inside the simulation domain. Note that the focus of the laser can have a longitudinal
position different from the laser center.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Reflective boundary conditions are chosen in all directions for the laser
envelope, since for the moment absorbing boundary conditions are not available.</p>
</div>
<p>The particles <code class="docutils literal notranslate"><span class="pre">Species</span></code> interacting with the envelope need a flag
<code class="docutils literal notranslate"><span class="pre">ponderomotive_dynamics=True</span></code> (normally <code class="docutils literal notranslate"><span class="pre">False</span></code> by default). The pusher
scheme that takes into account the envelope effect on the particles is called
<code class="docutils literal notranslate"><span class="pre">pusher=&quot;ponderomotive_boris&quot;</span></code>. Check that the defined <code class="docutils literal notranslate"><span class="pre">Species</span></code> has the
right <code class="docutils literal notranslate"><span class="pre">ponderomotive_dynamics</span></code> flag and the right <code class="docutils literal notranslate"><span class="pre">pusher</span></code> scheme.</p>
<p>After these checks, run the simulation and import the results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;/path/to/the/simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="a-subtlety-the-envelope-of-the-vector-potential-vs-the-envelope-of-the-electric-field">
<h2>A subtlety: the envelope of the vector potential vs the envelope of the electric field<a class="headerlink" href="#a-subtlety-the-envelope-of-the-vector-potential-vs-the-envelope-of-the-electric-field" title="Permalink to this headline">¶</a></h2>
<p>First, let’s study the laser propagation. Note the <code class="docutils literal notranslate"><span class="pre">MovingWindow</span></code> block and
that the window starts moving since the very first iteration of the simulation.
This allows the simulation domain to constantly shift toward the <cite>x</cite> direction
in order to follow the laser propagation.</p>
<p>Plot the values on the grid of the fields called <code class="docutils literal notranslate"><span class="pre">Env_A_abs</span></code> and <code class="docutils literal notranslate"><span class="pre">Env_E_abs</span></code>,
with the same scale. For this, use the diagnostic <code class="docutils literal notranslate"><span class="pre">Fields</span></code> (if the timestep is
not provided, the last one is plotted by default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;Env_A_abs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">2.85</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;Env_E_abs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">2.85</span><span class="p">)</span>
</pre></div>
</div>
<p>Do you see some differences?
The complex envelope field used for calculations is the envelope of the vector potential
<span class="math notranslate nohighlight">\(\tilde{A}\)</span>. In the diagnostics, you can plot its absolute value through <code class="docutils literal notranslate"><span class="pre">Env_A_abs</span></code>.
The field <code class="docutils literal notranslate"><span class="pre">Env_E_abs</span></code> is the absolute value of the envelope of the electric field <span class="math notranslate nohighlight">\(\tilde{E}\)</span>,
the latter defined to allow comparisons with the field of a standard laser:
<span class="math notranslate nohighlight">\(\tilde{E}=-(\partial_t-ik_0c)\tilde{A}\)</span> (see <a class="reference external" href="http://www.maisondelasimulation.fr/smilei/laser_envelope.html">Smilei’s website</a> for the derivation).
Remember that as explained in the documentation, when the laser
temporal variations are quick, the difference between the two fields will be
sensitive. Both the fields are complex quantities, the <cite>abs</cite> means that their
absolute value is plotted.</p>
<p>You can see how the two fields evolve differently in this nonliner case through then
diagnostic <code class="docutils literal notranslate"><span class="pre">Scalar</span></code>.
Through this diagnostic, you can plot the evolution of <code class="docutils literal notranslate"><span class="pre">Env_E_absMax</span></code> over time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Scalar</span><span class="p">(</span><span class="s2">&quot;Env_E_absMax&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Max</span></code> after the name of the field means that the maximum of that field on
the grid at each timestep will be plotted. You can see that after a brief diffraction
in vacuum, the value of <code class="docutils literal notranslate"><span class="pre">Env_E_absMax</span></code> is increasing over time due to relativistic
self-focusing and then starts to decrease again due to laser diffraction.</p>
<p>To plot the evolution of the maximum of the absolute value of the envelope
(of the vector potential) on the grid, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Scalar</span><span class="p">(</span><span class="s2">&quot;Env_A_absMax&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>To plot them in the same figure, you can use the command <code class="docutils literal notranslate"><span class="pre">multiPlot</span></code> of <code class="docutils literal notranslate"><span class="pre">happi</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env_E</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Scalar</span><span class="p">(</span><span class="s2">&quot;Env_E_absMax&quot;</span><span class="p">)</span>
<span class="n">env_A</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Scalar</span><span class="p">(</span><span class="s2">&quot;Env_A_absMax&quot;</span><span class="p">)</span>
<span class="n">happi</span><span class="o">.</span><span class="n">multiPlot</span><span class="p">(</span><span class="n">env_E</span><span class="p">,</span><span class="n">env_A</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see through their maximum value that initially the two fields are equal in vacuum.
Then, when the self-focusing starts, the temporal variations of the envelope are not negligible
and the two fields start to differ.</p>
</div>
<hr class="docutils" />
<div class="section" id="wakefield-excitation">
<h2>Wakefield excitation<a class="headerlink" href="#wakefield-excitation" title="Permalink to this headline">¶</a></h2>
<p>Now we are interested in the wakefield formation in the trail of the laser
envelope.</p>
<p>Through the diagnostic <code class="docutils literal notranslate"><span class="pre">Fields</span></code> and the option <code class="docutils literal notranslate"><span class="pre">animate</span></code>, you can follow
the envelope propagation during the simulation. As before, you can plot the
absolute value of the envelope <code class="docutils literal notranslate"><span class="pre">Env_E_abs</span></code>. Although the envelope represents
a laser pulse, you won’t see the laser oscillations at wavelength
<span class="math notranslate nohighlight">\(\lambda_0\)</span>. In the language of signal processing, with this model the
laser is represented through the complex envelope of the vector potential
component in the polarization direction. Indeed, the aim of the envelope model
is to simulate laser-plasma interaction without needing to resolve these high
frequency oscillations. This way, larger longitudinal grid sizes <code class="docutils literal notranslate"><span class="pre">dx</span></code> and
timesteps <code class="docutils literal notranslate"><span class="pre">dt</span></code> can be used, to considerably reduce the simulation time.</p>
<p>Through the diagnostic <code class="docutils literal notranslate"><span class="pre">Fields</span></code> and the option <code class="docutils literal notranslate"><span class="pre">animate</span></code>, you can follow
the formation of the wakefield, plotting the electron density <code class="docutils literal notranslate"><span class="pre">Rho</span></code>. To see
it more clearly, we recommend the use of the option <code class="docutils literal notranslate"><span class="pre">vmax</span></code> in the
<code class="docutils literal notranslate"><span class="pre">animate()</span></code> or <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;-Rho&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Note the formation of a bubble behind the laser, whose borders are full of
electrons and whose interior is emptied of electrons. A diagnostic of type
<code class="docutils literal notranslate"><span class="pre">Probe</span></code> is defined to see the values of some grid fields on the propagation
axis. The longitudinal electric field on axis, very important for electron
Laser Wakefield Acceleration, can be plotted in this way, choosing the field
<code class="docutils literal notranslate"><span class="pre">Ex</span></code> in your diagnostic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Through the function <code class="docutils literal notranslate"><span class="pre">animate</span></code>, follow the evolution of the envelope and the
electron density on the axis.</p>
</div>
<hr class="docutils" />
<div class="section" id="parametric-study-of-self-focusing-and-wakefield-excitation">
<h2>Parametric study of self-focusing and wakefield excitation<a class="headerlink" href="#parametric-study-of-self-focusing-and-wakefield-excitation" title="Permalink to this headline">¶</a></h2>
<p>Now let’s try to change the laser and plasma parameters to see how self the
self-focusing and the wake excitation change.</p>
<p>Try to repeat the simulation with different values of <cite>a0</cite> (the envelope initial peak value)
and <cite>n0</cite> (the plasma plateau density). What changes in the process of
self-focusing? Try the values <span class="math notranslate nohighlight">\(0.01\)</span>, <span class="math notranslate nohighlight">\(0.1\)</span>, <span class="math notranslate nohighlight">\(2.\)</span> for <cite>a0</cite>
and <span class="math notranslate nohighlight">\(0.003\)</span>, <span class="math notranslate nohighlight">\(0.005\)</span> for <cite>n0</cite>. Use the <code class="docutils literal notranslate"><span class="pre">Scalar</span></code> diagnostics to study the
evolution of <code class="docutils literal notranslate"><span class="pre">Env_E_absMax</span></code>.</p>
<p>Set the values of <cite>a0</cite> and <cite>n0</cite> to their original value (<span class="math notranslate nohighlight">\(2.7\)</span>
and <span class="math notranslate nohighlight">\(0.002\)</span> respectively) and rerun the simulation. Now try to relaunch
the simulation with different values of <cite>a0</cite> (like <span class="math notranslate nohighlight">\(0.01\)</span>, <span class="math notranslate nohighlight">\(0.1\)</span>,
<span class="math notranslate nohighlight">\(2.\)</span>). What happens to the waveform of <code class="docutils literal notranslate"><span class="pre">Ex</span></code> on the propagation axis?
And how changes the electron density on the 2D grid? Use the <code class="docutils literal notranslate"><span class="pre">Probe</span></code> and <code class="docutils literal notranslate"><span class="pre">Field</span></code>
diagnostics to study the changes in <code class="docutils literal notranslate"><span class="pre">Ex</span></code> and <code class="docutils literal notranslate"><span class="pre">Rho</span></code>.</p>
</div>
</div>


        </div></div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Oct 07, 2019
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            e.preventDefault();
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>