
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Field initialization for a relativistic electron bunch &#8212; Smilei tutorials 05aa8cc documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://www.gitcdn.xyz/cdn/mathjax/MathJax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Azimuthal-mode-decomposition cylindrical geometry" href="advanced_wakefield_AMcylindrical.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="basics_setup.html">Setup</a>
                </li>
                <li class="outer">
                    <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                </li>
                <li class="outer">
                    <a href="basics_thermal_plasma.html">Thermal plasma</a>
                </li>
                <li class="outer">
                    <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="perfs_parallel_computing.html">Parallel computing</a>
                </li>
                <li class="outer">
                    <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="advanced_field_ionization.html">Field ionization</a>
                </li>
                <li class="outer">
                    <a href="advanced_collisions.html">Binary collisions and impact ionization</a>
                </li>
                <li class="outer">
                    <a href="advanced_radiation_reaction.html">Synchrotron-like Radiation reaction processes</a>
                </li>
                <li class="outer">
                    <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_envelope.html">Envelope model for laser wakefield acceleration</a>
                </li>
                <li class="outer">
                    <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                </li>
            </ul>
                <ul>
<li><a class="reference internal" href="#">Field initialization for a relativistic electron bunch</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#preparing-the-case-study">Preparing the case study</a></li>
<li><a class="reference internal" href="#a-subtlety-why-ions-are-not-present">A subtlety: why ions are not present?</a></li>
<li><a class="reference internal" href="#relativistic-field-initialization">Relativistic field initialization</a></li>
<li><a class="reference internal" href="#nonlinear-beam-driven-plasma-oscillations">Nonlinear, beam-driven plasma oscillations</a></li>
</ul>
</li>
</ul>

            <ul>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Field initialization for a relativistic electron bunch</a></div>
                <ul>
<li><a class="reference internal" href="#">Field initialization for a relativistic electron bunch</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#preparing-the-case-study">Preparing the case study</a></li>
<li><a class="reference internal" href="#a-subtlety-why-ions-are-not-present">A subtlety: why ions are not present?</a></li>
<li><a class="reference internal" href="#relativistic-field-initialization">Relativistic field initialization</a></li>
<li><a class="reference internal" href="#nonlinear-beam-driven-plasma-oscillations">Nonlinear, beam-driven plasma oscillations</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_PIC basics"
            
        >
            <div id="menuButton_PIC basics" class="menuButton"
                 onmouseenter="prepareMenu('menu_PIC basics')"
                 onmousedown="event.preventDefault()"
            >
                <a href="basics.html">
                    <span>PIC basics</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_PIC basics',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="basics_setup.html">Setup</a>
                        </li>
                        <li class="outer">
                            <a href="basics_laser_vacuum.html">Laser Propagation in vacuum</a>
                        </li>
                        <li class="outer">
                            <a href="basics_thermal_plasma.html">Thermal plasma</a>
                        </li>
                        <li class="outer">
                            <a href="basics_weibel_twostream.html">Weibel and two-stream instabilities</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Performances"
            
        >
            <div id="menuButton_Performances" class="menuButton"
                 onmouseenter="prepareMenu('menu_Performances')"
                 onmousedown="event.preventDefault()"
            >
                <a href="perfs.html">
                    <span>Performances</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Performances',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="perfs_parallel_computing.html">Parallel computing</a>
                        </li>
                        <li class="outer">
                            <a href="perfs_patch_arrangement.html">Patch arrangement</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Advanced"
            style="font-weight:bold"
        >
            <div id="menuButton_Advanced" class="menuButton"
                 onmouseenter="prepareMenu('menu_Advanced')"
                 onmousedown="event.preventDefault()"
            >
                <a href="advanced.html">
                    <span>Advanced</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Advanced',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="advanced_field_ionization.html">Field ionization</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_collisions.html">Binary collisions and impact ionization</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_radiation_reaction.html">Synchrotron-like Radiation reaction processes</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_breit_wheeler.html">Multiphoton Breit-Wheeler pair creation process</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield.html">2D laser wakefield acceleration</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_envelope.html">Envelope model for laser wakefield acceleration</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_wakefield_AMcylindrical.html">Azimuthal-mode-decomposition cylindrical geometry</a>
                        </li>
                        <li >
                            <a href="#">Field initialization for a relativistic electron bunch</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
    <div class="documentwrapper">
        <div class="body" role="main">
          
  <div class="section" id="field-initialization-for-a-relativistic-electron-bunch">
<h1>Field initialization for a relativistic electron bunch<a class="headerlink" href="#field-initialization-for-a-relativistic-electron-bunch" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to give an introduction to the use of the the
relativistic-species field initialization with <strong class="program">Smilei</strong>.</p>
<p>We recommend to run the simulations of this tutorial with 4 MPI processes
(remember to set the number of OpenMP threads as explained in <a class="reference internal" href="basics_setup.html"><span class="doc">Setup</span></a>).</p>
<p>The following features will be addressed:</p>
<ul class="simple">
<li>Initialization of the electromagnetic field with relativistic species</li>
<li>Observation of the plasma wakefield driven by a relativistic electron bunch</li>
</ul>
<hr class="docutils" />
<div class="section" id="physical-configuration">
<h2>Physical configuration<a class="headerlink" href="#physical-configuration" title="Permalink to this headline">¶</a></h2>
<p>A relativistic electron bunch enters a plasma in a 2D geometry. It propagates in
the plasma and creates a non linear plasma wave in its wake.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial is done in 2D which is not physically relevant.
Proper simulation of this kind must be done in 3D
or in cylindrical geometry with azimuthal mode decomposition (see the related tutorial).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial is done with an ideal relativistic electron bunch (zero emittance, zero energy spread).
A more realistic simulation would have an electron bunch with a spread in the transverse and longitudinal momentum.
This unrealistic set-up will trigger a sudden and exaggerated self-compression of the bunch by its own plasma wakefield
during its propagation.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="preparing-the-case-study">
<h2>Preparing the case study<a class="headerlink" href="#preparing-the-case-study" title="Permalink to this headline">¶</a></h2>
<p>Download the input file <a class="reference external" href="beam_driven_wake.py">beam_driven_wake.py</a> and open it with your
favorite editor.</p>
<p>The plasma electrons are initialized in a block <code class="docutils literal notranslate"><span class="pre">Species</span></code> named <code class="docutils literal notranslate"><span class="pre">electrons</span></code>.
The electron bunch driving the plasma wave is initalized in
a block <code class="docutils literal notranslate"><span class="pre">Species</span></code> named <code class="docutils literal notranslate"><span class="pre">bunch_electrons</span></code>.
It has a custom density profile (gaussian in this case) and
a mean velocity <code class="docutils literal notranslate"><span class="pre">beta</span></code>. This is an ideal electron bunch, since it has no energy spread,
no transverse momentum spread (or equivalently zero emittance).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To have a more realistic electron bunch,
you could initialize the positions and momenta of each particle with numpy arrays,
as explained <a class="reference external" href="http://www.maisondelasimulation.fr/smilei/namelist.html#position_initialization">here</a>.</p>
</div>
<p>The special flag <code class="docutils literal notranslate"><span class="pre">relativistic_field_initialization</span> <span class="pre">=</span> <span class="pre">True</span></code>
means that its self-consistent electromagnetic fields will be computed at the time when
this <code class="docutils literal notranslate"><span class="pre">Species</span></code> starts to move, in this case at <code class="docutils literal notranslate"><span class="pre">t=0</span></code> because <code class="docutils literal notranslate"><span class="pre">time_frozen=0</span></code>.
The procedure used in <strong class="program">Smilei</strong> for this initialization is detailed
<a class="reference external" href="http://www.maisondelasimulation.fr/smilei/relativistic_fields_initialization.html">here</a>.</p>
<p>These electromagnetic fields will propagate with the bunch and push away the plasma electrons
(just like an intense laser pulse would do with its ponderomotive force)
triggering a plasma oscillation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Imperfect boundary condition cause unphysical effects when the bunch’s intense
electromagnetic fields arrive at the boundaries of the simulation window.
A larger box (transversally) could help fields decay near the boundaries.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The moving window in the namelist has been set to contain the electron bunch and the first wake period in the simulation window.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will see that the plasma does not fill all the simulation window.
This is because we want to include the electron bunch field in the window, but the plasma particles creating the plasma oscillations
are only those radially near to the electron beam. Plasma particles at greater radial distances would not contribute to the relevant physics, but they would
require additional computational time. Thus we can omit them to perform the simulation more quickly without losing relevant phenomena.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="a-subtlety-why-ions-are-not-present">
<h2>A subtlety: why ions are not present?<a class="headerlink" href="#a-subtlety-why-ions-are-not-present" title="Permalink to this headline">¶</a></h2>
<p>Maxwell’s equations and the continuity equation <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{J}=-\partial_t\rho\)</span>
(which is true also for the single species) imply that <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{E}-\rho\)</span> remains
constant throughout the simulation
(see <a class="reference external" href="http://www.maisondelasimulation.fr/smilei/relativistic_fields_initialization.html">this</a>).
This can be written <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{E}-\rho_e-\rho_i=\nabla\cdot\mathbf{E_0}-\rho_{e0}-\rho_{i0}\)</span>.
If we consider ions immobile, then this becomes <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{E}-\rho_e=\nabla\cdot\mathbf{E_0}-\rho_{e0}\)</span>,
because the ion continuity equation implies that if <span class="math notranslate nohighlight">\(\mathbf{J}_{i}=0\)</span> then <span class="math notranslate nohighlight">\(\rho_i=\rho_{i0}\)</span>.
Note that ions do not appear anymore so that they can be discarded from the simulation.
Assuming also <span class="math notranslate nohighlight">\(\rho_{e0}+\rho_{i0}=0\)</span> and the initial field <span class="math notranslate nohighlight">\(\mathbf{E_0}\)</span> being divergence free,
we have <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{E}=\rho_e+\rho_{i0}\)</span> at all times.
The system will evolve as if there were ions, without having a real ion <code class="docutils literal notranslate"><span class="pre">Species</span></code>.</p>
<p>This is a good approximation in our case: plasma oscillations driven by a relativistic
electron bunch do not substantially move the ions. Indeed, the ion mass is at least 2000 times greater than the mass of an electron, so the characteristic timescales of the ion motion are much greater than those of the electron motion. Discarding ions represents an important gain of
computational time.
If we were interested in phenomena like ionization or ion motion,
we would have needed to explicitly define an ion <code class="docutils literal notranslate"><span class="pre">Species</span></code>.</p>
</div>
<hr class="docutils" />
<div class="section" id="relativistic-field-initialization">
<h2>Relativistic field initialization<a class="headerlink" href="#relativistic-field-initialization" title="Permalink to this headline">¶</a></h2>
<p>Run the simulation and open the results with <code class="docutils literal notranslate"><span class="pre">happi</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;/path/to/the/simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To visualize the initial bunch density and electric field, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;-Rho&quot;</span><span class="p">,</span><span class="n">timesteps</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span><span class="n">timesteps</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;Ey&quot;</span><span class="p">,</span><span class="n">timesteps</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the bunch is initially in vacuum. If a <code class="docutils literal notranslate"><span class="pre">Species</span></code> is initialized inside the plasma,
activating the initialization of its field creates non-physical forces.</p>
<p>The bunch will move in the positive <code class="docutils literal notranslate"><span class="pre">x</span></code> (longitudinal) direction towards the plasma.
The field <code class="docutils literal notranslate"><span class="pre">Ex</span></code> is much lower than the transverse field <code class="docutils literal notranslate"><span class="pre">Ey</span></code> as for a relativistic moving charge.
The field <code class="docutils literal notranslate"><span class="pre">Ey</span></code> is the field that pushes the plasma electrons away from the bunch’s path and triggers the plasma oscillations
in the bunch wake.</p>
</div>
<hr class="docutils" />
<div class="section" id="nonlinear-beam-driven-plasma-oscillations">
<h2>Nonlinear, beam-driven plasma oscillations<a class="headerlink" href="#nonlinear-beam-driven-plasma-oscillations" title="Permalink to this headline">¶</a></h2>
<p>The plasma electrons pushed away from the bunch path will be attracted back to their original positions
by the immobile ions and start to oscillate.</p>
<p>Visualize the nonlinear plasma wave forming in the wake of the electron bunch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;-Rho&quot;</span><span class="p">,)</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The evolution of the longitudinal electric field on axis, very important for acceleration of another particle bunch,
can be visualized through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The wave form has a shape between a sinusoidal wave and a sawtooth wave,
since the set-up is in the so-called weakly nonlinear regime.</p>
<p>Try to change the normalized peak density of the bunch <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and rerun the simulation, for example with the values
<code class="docutils literal notranslate"><span class="pre">0.001</span></code> (a linear regime), <code class="docutils literal notranslate"><span class="pre">1.5</span></code> (a nonlinear regime). What happens to the <code class="docutils literal notranslate"><span class="pre">Ex</span></code> waveform?</p>
<p>Visualize the nonlinear plasma wave forming in the wake of the electron bunch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">Field0</span><span class="p">(</span><span class="s2">&quot;-Rho&quot;</span><span class="p">,)</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The evolution of the longitudinal electric field on axis, very important for acceleration of another particle bunch,
can be visualized through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The wave form has a shape between a sinusoidal wave and a sawtooth wave,
since the set-up is in the so-called weakly nonlinear regime.</p>
<p>Try to change the normalized peak density of the bunch <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and rerun the simulation, for example with the values
<code class="docutils literal notranslate"><span class="pre">0.001</span></code> (a linear regime), <code class="docutils literal notranslate"><span class="pre">1.5</span></code> (a nonlinear regime). What happens to the <code class="docutils literal notranslate"><span class="pre">Ex</span></code> waveform?</p>
</div>
</div>


        </div></div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Oct 07, 2019
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            e.preventDefault();
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>